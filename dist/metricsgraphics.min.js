!function(a,b){"function"==typeof define&&define.amd?define(["d3","jquery"],function(a,c){return b(a,c)}):"object"==typeof exports?module.exports=b(require("d3"),require("jquery")):b(d3,jquery)}(this,function(a){function b(b){"use strict";var c=a.select(b.target);if(c.select(".mg-chart-title").remove(),b.target&&b.title){var d=b.show_tooltips&&b.description?'<i class="fa fa-question-circle fa-inverse description"></i>':"";if(c.insert("h2",":first-child").attr("class","mg-chart-title").html(b.title+d),b.show_tooltips&&b.description){var e=$(c.node()).find("h2.mg-chart-title");e.popover({html:!0,animation:!1,content:b.description,trigger:"hover",placement:"top",container:e})}}b.error&&N(b)}function c(a){"use strict";for(var b=E(a.target),c="point"===a.chart_type?a.buffer/2:2*a.buffer/3,d=[],e=0;e<a.data.length;e++)for(var f=0;f<a.data[e].length;f++)d.push(a.data[e][f]);var g=b.selectAll("line.mg-y-rug").data(d);g.enter().append("svg:line").attr("class","mg-y-rug").attr("opacity",.3),g.exit().remove(),g.exit().remove(),g.attr("x1",a.left+1).attr("x2",a.left+c).attr("y1",a.scalefns.yf).attr("y2",a.scalefns.yf),a.color_accessor?(g.attr("stroke",a.scalefns.color),g.classed("mg-y-rug-mono",!1)):(g.attr("stroke",null),g.classed("mg-y-rug-mono",!0))}function d(b){function d(a){return 1e3===a?3:1e6===a?7:Math.log(a)/Math.LN10}b.processed||(b.processed={});var e,f,g,h=E(b.target);b.scalefns.yf=function(a){return b.missing_is_hidden&&a.missing?b.scales.Y(a[b.y_accessor])+42.1234:b.scales.Y(a[b.y_accessor])};for(var i=!1,j=function(a){return a[b.y_accessor]>0},k=function(a){return a[b.y_accessor]},l=0;l<b.data.length;l++){var m=b.data[l];if("log"===b.y_scale_type&&(m=m.filter(j)),m.length>0){var n=a.extent(m,k);i?(f=Math.min(n[0],f),g=Math.max(n[1],g)):(f=n[0],g=n[1],i=!0)}}f>=0&&!b.min_y&&!b.min_y_from_data&&(f=0),"bar"===b.chart_type&&(f=0,g=a.max(b.data[0],function(a){var c=[];return c.push(a[b.y_accessor]),null!==b.baseline_accessor&&c.push(a[b.baseline_accessor]),null!==b.predictor_accessor&&c.push(a[b.predictor_accessor]),Math.max.apply(null,c)})),f=null!==b.min_y?b.min_y:f,g=null!==b.max_y?b.max_y:g*b.inflator,"log"!==b.y_scale_type&&(f>=0?b.y_axis_negative=!1:(f-=g*(b.inflator-1),b.y_axis_negative=!0)),!b.min_y&&b.min_y_from_data&&(f/=b.inflator),"log"===b.y_scale_type?("histogram"===b.chart_type?f=.2:0>=f&&(f=1),b.scales.Y=a.scale.log().domain([f,g]).range([b.height-b.bottom-b.buffer,b.top]).clamp(!0)):b.scales.Y=a.scale.linear().domain([f,g]).range([b.height-b.bottom-b.buffer,b.top]),b.processed.min_y=f,b.processed.max_y=g,b.scales.Y_axis=a.scale.linear().domain([b.processed.min_y,b.processed.max_y]).range([b.height-b.bottom-b.buffer,b.top]);var o=b.yax_format;if(o||(o="count"===b.format?function(c){if(1>c)return b.yax_units+a.round(c,b.decimals);var d=a.formatPrefix(c);return b.yax_units+d.scale(c)+d.symbol}:function(b){var c=a.format("%p");return c(b)}),h.selectAll(".mg-y-axis").remove(),!b.y_axis)return this;e=h.append("g").classed("mg-y-axis",!0).classed("mg-y-axis-small",b.use_small_class),b.y_label&&e.append("text").attr("class","label").attr("x",function(){return-1*(b.top+b.buffer+(b.height-b.bottom-b.buffer-(b.top+b.buffer))/2)}).attr("y",function(){return b.left/2}).attr("dy","0.4em").attr("text-anchor","middle").text(function(){return b.y_label}).attr("transform",function(){return"rotate(-90)"});var p=b.scales.Y.ticks(b.yax_count);"log"===b.y_scale_type&&(p=p.filter(function(a){return Math.abs(d(a))%1<1e-6||Math.abs(d(a))%1>1-1e-6}));var q=b.scales.Y.ticks(b.yax_count).length,r=!0;b.data.forEach(function(a){a.forEach(function(a){return a[b.y_accessor]%1!==0?(r=!1,!1):void 0})}),r&&q>g&&"count"===b.format&&(p=p.filter(function(a){return a%1===0}));var s=p.length-1;return b.x_extended_ticks||b.y_extended_ticks||e.append("line").attr("x1",b.left).attr("x2",b.left).attr("y1",b.scales.Y(p[0]).toFixed(2)).attr("y2",b.scales.Y(p[s]).toFixed(2)),e.selectAll(".mg-yax-ticks").data(p).enter().append("line").classed("mg-extended-y-ticks",b.y_extended_ticks).attr("x1",b.left).attr("x2",function(){return b.y_extended_ticks?b.width-b.right:b.left-b.yax_tick_length}).attr("y1",function(a){return b.scales.Y(a).toFixed(2)}).attr("y2",function(a){return b.scales.Y(a).toFixed(2)}),e.selectAll(".mg-yax-labels").data(p).enter().append("text").attr("x",b.left-3*b.yax_tick_length/2).attr("dx",-3).attr("y",function(a){return b.scales.Y(a).toFixed(2)}).attr("dy",".35em").attr("text-anchor","end").text(function(a){var b=o(a);return b}),b.y_rug&&c(b),this}function e(b){b.scales.Y=a.scale.ordinal().domain(b.categorical_variables).rangeRoundBands([b.height-b.bottom-b.buffer,b.top],b.padding_percentage,b.outer_padding_percentage),b.scalefns.yf=function(a){return b.scales.Y(a[b.y_accessor])};var c=E(b.target);c.selectAll(".mg-y-axis").remove();var d=c.append("g").classed("mg-y-axis",!0).classed("mg-y-axis-small",b.use_small_class);return b.y_axis?(d.selectAll("text").data(b.categorical_variables).enter().append("svg:text").attr("x",b.left).attr("y",function(a){return b.scales.Y(a)+b.scales.Y.rangeBand()/2+b.buffer*b.outer_padding_percentage}).attr("dy",".35em").attr("text-anchor","end").text(String),this):this}function f(a){"use strict";for(var b="point"===a.chart_type?a.buffer/2:a.buffer,c=E(a.target),d=[],e=0;e<a.data.length;e++)for(var f=0;f<a.data[e].length;f++)d.push(a.data[e][f]);var g=c.selectAll("line.mg-x-rug").data(d);g.enter().append("svg:line").attr("class","mg-x-rug").attr("opacity",.3),g.exit().remove(),g.exit().remove(),g.attr("x1",a.scalefns.xf).attr("x2",a.scalefns.xf).attr("y1",a.height-a.top+b).attr("y2",a.height-a.top),a.color_accessor?(g.attr("stroke",a.scalefns.color),g.classed("mg-x-rug-mono",!1)):(g.attr("stroke",null),g.classed("mg-x-rug-mono",!0))}function g(b){"use strict";var c,d=E(b.target);if(b.processed={},b.scalefns.xf=function(a){return b.scales.X(a[b.x_accessor])},"point"===b.chart_type&&(i(b),j(b)),p(b),b.scales.X=b.time_series?a.time.scale():a.scale.linear(),b.scales.X.domain([b.processed.min_x,b.processed.max_x]).range([b.left+b.buffer,b.width-b.right-b.buffer-b.additional_buffer]),d.selectAll(".mg-x-axis").remove(),!b.x_axis)return this;c=d.append("g").classed("mg-x-axis",!0).classed("mg-x-axis-small",b.use_small_class);b.scales.X.ticks(b.xax_count).length-1;return b.x_label&&k(c,b),n(c,b),o(c,b),b.x_rug&&f(b),this}function h(b){var c=E(b.target),d=(b.width,0);"bar"===b.chart_type&&(d=b.buffer+5),b.scales.X=a.scale.ordinal().domain(b.categorical_variables.reverse()).rangeRoundBands([b.left,b.width-b.right-b.buffer-d]),b.scalefns.xf=function(a){return b.scales.X(a[b.x_accessor])},c.selectAll(".mg-x-axis").remove();var e=c.append("g").classed("mg-x-axis",!0).classed("mg-x-axis-small",b.use_small_class);if(!b.x_axis)return this;var f=e.selectAll("text").data(b.categorical_variables).enter().append("svg:text");return f.attr("x",function(a){return b.scales.X(a)+b.scales.X.rangeBand()/2+b.buffer*b.outer_padding_percentage+d/2}).attr("y",b.height-b.bottom+b.buffer).attr("dy",".35em").attr("text-anchor","middle").text(String),f.each(function(a){var c=this,d=b.scales.X.rangeBand();M(c,a,d)}),this}function i(b){var c,d,e,f;null!==b.color_accessor&&(null===b.color_domain?"number"===b.color_type?(c=a.min(b.data[0],function(a){return a[b.color_accessor]}),d=a.max(b.data[0],function(a){return a[b.color_accessor]}),e=[c,d]):"category"===b.color_type&&(e=a.set(b.data[0].map(function(a){return a[b.color_accessor]})).values(),e.sort()):e=b.color_domain,f=null===b.color_range?"number"===b.color_type?["blue","red"]:null:b.color_range,"number"===b.color_type?b.scales.color=a.scale.linear().domain(e).range(f).clamp(!0):(b.scales.color=null!==b.color_range?a.scale.ordinal().range(f):e.length>10?a.scale.category20():a.scale.category10(),b.scales.color.domain(e)),b.scalefns.color=function(a){return b.scales.color(a[b.color_accessor])})}function j(b){var c,d,e,f;null!==b.size_accessor&&(null===b.size_domain?(c=a.min(b.data[0],function(a){return a[b.size_accessor]}),d=a.max(b.data[0],function(a){return a[b.size_accessor]}),e=[c,d]):e=b.size_domain,f=null===b.size_range?[1,5]:b.size_range,b.scales.size=a.scale.linear().domain(e).range(f).clamp(!0),b.scalefns.size=function(a){return b.scales.size(a[b.size_accessor])})}function k(a,b){a.append("text").attr("class","label").attr("x",function(){return b.left+b.buffer+(b.width-b.right-b.buffer-(b.left+b.buffer))/2}).attr("y",(b.height-b.bottom/2).toFixed(2)).attr("dy",".50em").attr("text-anchor","middle").text(function(){return b.x_label})}function l(b){return b.xax_format?b.xax_format:function(c){if(1>c)return b.xax_units+a.round(c,b.decimals);var d=a.formatPrefix(c);return b.xax_units+d.scale(c)+d.symbol}}function m(b){if(b.xax_format)return b.xax_format;var c,d,e;return b.time_series&&(c=(b.processed.max_x-b.processed.min_x)/1e3,60>c?(d=a.time.format("%M:%S"),e="seconds"):24>=c/3600?(d=a.time.format("%H:%M"),e="less-than-a-day"):96>=c/3600?(d=a.time.format("%H:%M"),e="four-days"):(d=a.time.format("%b %d"),e="default")),b.processed.main_x_time_format=d,b.processed.x_time_frame=e,function(c){var d=(a.time.format("%b %d"),a.formatPrefix(c));return b.data[0][0][b.x_accessor]instanceof Date?b.processed.main_x_time_format(c):"number"==typeof b.data[0][0][b.x_accessor]?1>c?b.xax_units+a.round(c,b.decimals):(d=a.formatPrefix(c),b.xax_units+d.scale(c)+d.symbol):c}}function n(a,b){var c=b.scales.X.ticks(b.xax_count).length-1;"bar"===b.chart_type||b.x_extended_ticks||b.y_extended_ticks||a.append("line").attr("x1",b.concise===!1||0===b.xax_count?b.left+b.buffer:b.scales.X(b.scales.X.ticks(b.xax_count)[0]).toFixed(2)).attr("x2",b.concise===!1||0===b.xax_count?b.width-b.right-b.buffer:b.scales.X(b.scales.X.ticks(b.xax_count)[c]).toFixed(2)).attr("y1",b.height-b.bottom).attr("y2",b.height-b.bottom),a.selectAll(".mg-xax-ticks").data(b.scales.X.ticks(b.xax_count)).enter().append("line").attr("x1",function(a){return b.scales.X(a).toFixed(2)}).attr("x2",function(a){return b.scales.X(a).toFixed(2)}).attr("y1",b.height-b.bottom).attr("y2",function(){return b.x_extended_ticks?b.top:b.height-b.bottom+b.xax_tick_length}).attr("class",function(){return b.x_extended_ticks?"mg-extended-x-ticks":void 0})}function o(b,c){if(b.selectAll(".mg-xax-labels").data(c.scales.X.ticks(c.xax_count)).enter().append("text").attr("x",function(a){return c.scales.X(a).toFixed(2)}).attr("y",(c.height-c.bottom+7*c.xax_tick_length/3).toFixed(2)).attr("dy",".50em").attr("text-anchor","middle").text(function(a){return c.xax_units+c.xax_format(a)}),c.time_series&&(c.show_years||c.show_secondary_x_label)){var d,e,f=c.processed.x_time_frame;switch(f){case"seconds":d=a.time.days,e=a.time.format("%I %p");break;case"less-than-a-day":d=a.time.days,e=a.time.format("%b %d");break;case"four-days":d=a.time.days,e=a.time.format("%b %d");break;default:d=a.time.years,e=a.time.format("%Y")}var g=d(c.processed.min_x,c.processed.max_x);if(0===g.length){var h=c.scales.X.ticks(c.xax_count)[0];g=[h]}b=b.append("g").classed("mg-year-marker",!0).classed("mg-year-marker-small",c.use_small_class),"default"===f&&b.selectAll(".mg-year-marker").data(g).enter().append("line").attr("x1",function(a){return c.scales.X(a).toFixed(2)}).attr("x2",function(a){return c.scales.X(a).toFixed(2)}).attr("y1",c.top).attr("y2",c.height-c.bottom),b.selectAll(".mg-year-marker").data(g).enter().append("text").attr("x",function(a){return c.scales.X(a).toFixed(2)}).attr("y",(c.height-c.bottom+7*c.xax_tick_length/1.3).toFixed(2)).attr("dy",c.use_small_class?-3:0).attr("text-anchor","middle").text(function(a){return e(a)})}}function p(b){var c,d,e=[],f=[].concat.apply([],b.data),g=function(a){return a[b.x_accessor]};if(delete b.xax_format,"line"===b.chart_type||"point"===b.chart_type||"histogram"===b.chart_type?(e=a.extent(f,g),c=e[0],d=e[1]):"bar"===b.chart_type&&(c=0,d=a.max(f,function(a){var c=[a[b.x_accessor],a[b.baseline_accessor]?a[b.baseline_accessor]:0,a[b.predictor_accessor]?a[b.predictor_accessor]:0];return Math.max.apply(null,c)})),c===d){if(c instanceof Date){var h=MG.clone(c).setDate(c.getDate()-1),i=MG.clone(c).setDate(c.getDate()+1);c=h,d=i}else"number"==typeof c?(c-=1,d+=1):"string"==typeof c&&(c=Number(c)-1,d=Number(d)+1);b.xax_count=2}c=b.min_x?b.min_x:c,d=b.max_x?b.max_x:d,b.x_axis_negative=!1,b.processed.min_x=c,b.processed.max_x=d,q(b),b.time_series||b.processed.min_x<0&&(b.processed.min_x=b.processed.min_x-b.processed.max_x*(b.inflator-1),b.x_axis_negative=!0),b.additional_buffer="bar"===b.chart_type?5*b.buffer:0}function q(a){a.xax_format||"line"!==a.chart_type||(a.xax_format=m(a)),a.xax_format||"point"!==a.chart_type||(a.xax_format=m(a)),a.xax_format||"histogram"!==a.chart_type||(a.xax_format=m(a)),a.xax_format||"bar"!==a.chart_type||(a.xax_format=l(a))}function r(c){"use strict";var d={target:null,title:null,description:null};if(c=arguments[0],c||(c={}),c=J(c,d),a.select(c.target).empty())return void console.warn('The specified target element "'+c.target+'" could not be found in the page. The chart will not be rendered.');var e=a.select(c.target),f=e.selectAll("svg");c.time_series=c.data[0][0][c.x_accessor]instanceof Date?!0:!1;var g=c.width,h=c.height;c.full_width&&(g=H(c.target)),c.fill_height&&(h=I(c.target)),"bar"===c.chart_type&&null===h&&(h=c.height=c.data[0].length*c.bar_height+c.top+c.bottom),(!f.selectAll(".mg-main-line").empty()&&"line"!==c.chart_type||!f.selectAll(".mg-points").empty()&&"point"!==c.chart_type||!f.selectAll(".mg-histogram").empty()&&"histogram"!==c.chart_type||!f.selectAll(".mg-barplot").empty()&&"bar"!==c.chart_type)&&f.remove(),E(c.target).empty()&&(f=a.select(c.target).append("svg").classed("linked",c.linked).attr("width",g).attr("height",h)),c.width=g,c.height=h,f.selectAll(".mg-clip-path").remove(),f.append("defs").attr("class","mg-clip-path").append("clipPath").attr("id","mg-plot-window-"+F(c.target)).append("svg:rect").attr("x",c.left).attr("y",c.top).attr("width",c.width-c.left-c.right-c.buffer).attr("height",c.height-c.top-c.bottom-c.buffer+1),g!==Number(f.attr("width"))&&f.attr("width",g),h!==Number(f.attr("height"))&&f.attr("height",h),f.attr("viewBox","0 0 "+g+" "+h),(c.full_width||c.full_height)&&f.attr("preserveAspectRatio","xMinYMin meet"),f.classed("mg-missing",!1),f.selectAll(".mg-missing-text").remove(),f.selectAll(".mg-missing-pane").remove(),b(c),c.use_small_class=c.height-c.top-c.bottom-c.buffer<=c.small_height_threshold&&c.width-c.left-c.right-2*c.buffer<=c.small_width_threshold||c.small_text;var i=0;if(c.data.length<f.selectAll(".mg-main-line")[0].length)if(c.custom_line_color_map.length>0){var j=function(a){for(var b=new Array(a),c=0;c<b.length;c++)b[c]=c+1;return b},k=K(j(c.max_data_size),c.custom_line_color_map);for(i=0;i<k.length;i++)f.selectAll(".mg-main-line.mg-line"+k[i]+"-color").remove()}else{var l=c.data.length,m=f.selectAll(".mg-main-line")[0].length;for(i=m;i>l;i--)f.selectAll(".mg-main-line.mg-line"+i+"-color").remove()}return this}function s(b){"use strict";function c(c){var e;c.each(function(f,g){if(g>0){{this.getBoundingClientRect()}if(d(this,c)){var h=a.select(this),i=+h.attr("y");i+8==b.top&&(i=b.top-16),h.attr("y",i)}}e=this})}function d(a,b){for(var c=a.getBoundingClientRect(),d=0;d<b.length;d++){var e=b[0][d].getBoundingClientRect();if(b[0][d]!==a&&(e.right>c.left&&e.left>c.left&&c.top===e.top||e.left<c.left&&e.right>c.left&&c.top===e.top))return!0}return!1}function e(a){return b.scales.X(a[b.x_accessor])}function f(a){return e(a).toFixed(2)}function g(a){return b.scales.X(a[b.x_accessor])>b.buffer+b.left&&b.scales.X(a[b.x_accessor])<b.width-b.buffer-b.right}var h,i,j=E(b.target);return j.selectAll(".mg-markers").remove(),j.selectAll(".mg-baselines").remove(),b.markers&&(h=j.append("g").attr("class","mg-markers"),h.selectAll(".mg-markers").data(b.markers.filter(g)).enter().append("line").attr("x1",f).attr("x2",f).attr("y1",b.top).attr("y2",function(){return b.height-b.bottom-b.buffer}).attr("stroke-dasharray","3,1"),h.selectAll(".mg-markers").data(b.markers.filter(g)).enter().append("text").attr("class","mg-marker-text").attr("x",e).attr("y",b.top-8).attr("text-anchor","middle").text(function(a){return a.label}),c(h.selectAll(".mg-marker-text"))),b.baselines&&(i=j.append("g").attr("class","mg-baselines"),i.selectAll(".mg-baselines").data(b.baselines).enter().append("line").attr("x1",b.left+b.buffer).attr("x2",b.width-b.right-b.buffer).attr("y1",function(a){return b.scales.Y(a.value).toFixed(2)}).attr("y2",function(a){return b.scales.Y(a.value).toFixed(2)}),i.selectAll(".mg-baselines").data(b.baselines).enter().append("text").attr("x",b.width-b.right-b.buffer).attr("y",function(a){return b.scales.Y(a.value).toFixed(2)}).attr("dy",-3).attr("text-anchor","end").text(function(a){return a.label})),this}function t(a){u(a)}function u(b){(b.full_width||b.full_height)&&window.addEventListener("resize",function(){var c=a.select(b.target).select("svg"),d=c.attr("height")/c.attr("width"),e=H(b.target);c.attr("width",e),c.attr("height",d*e)},!0)}function v(a){"use strict";if("line"===a.chart_type){var b=a.data[0]instanceof Object&&!(a.data[0]instanceof Array),c=a.data[0]instanceof Array&&!(a.data[0][0]instanceof Object&&!(a.data[0][0]instanceof Date));(b||c)&&(a.data=[a.data])}else a.data[0]instanceof Array||(a.data=[a.data]);if(a.y_accessor instanceof Array&&(a.data=a.data.map(function(b){return a.y_accessor.map(function(a){return b.map(function(b){return b=MG.clone(b),void 0===b[a]?void 0:(b.multiline_y_accessor=b[a],b)}).filter(function(a){return void 0!==a})})})[0],a.y_accessor="multiline_y_accessor"),"line"===a.chart_type)for(var d=0;d<a.data.length;d++)a.data[d].sort(function(b,c){return b[a.x_accessor]-c[a.x_accessor]});return this}function w(a){"use strict";var b=a.data[0][0][a.x_accessor]instanceof Date?!0:!1;if(a.missing_is_hidden&&(a.interpolate="linear"),(a.missing_is_zero||a.missing_is_hidden)&&"line"===a.chart_type&&b)for(var c=0;c<a.data.length;c++)if(1!=a.data[c].length){for(var d=a.data[c][0],e=a.data[c][a.data[c].length-1],f=[],g=MG.clone(d[a.x_accessor]).setDate(d[a.x_accessor].getDate()+1),h=a.min_x?a.min_x:g,i=a.max_x?a.max_x:e[a.x_accessor],j=new Date(h);i>=j;j.setDate(j.getDate()+1)){var k={};j.setHours(0,0,0,0),Date.parse(j)===Date.parse(new Date(g))&&f.push(MG.clone(a.data[c][0]));var l=null;a.data[c].forEach(function(b){return Date.parse(b[a.x_accessor])===Date.parse(new Date(j))?(l=b,!1):void 0}),l?f.push(l):(k[a.x_accessor]=new Date(j),k[a.y_accessor]=0,k.missing=!0,f.push(k)),Date.parse(j)===Date.parse(new Date(e[a.x_accessor]))&&f.push(e)}a.data[c]=f}return this}function x(b){"use strict";var c,d=b.data[0];if(b.binned===!1){if("object"==typeof d[0])c=d.map(function(a){return a[b.x_accessor]});else{if("number"!=typeof d[0])return void console.log("TypeError: expected an array of numbers, found "+typeof d[0]);c=d}var e=a.layout.histogram();b.bins&&(e=e.bins(b.bins)),b.processed_data=e(c).map(function(a){return{x:a.x,y:a.y,dx:a.dx}})}else{b.processed_data=d.map(function(a){return{x:a[b.x_accessor],y:a[b.y_accessor]}});for(var f,g,h=0;h<b.processed_data.length;h++)f=b.processed_data[h],h===b.processed_data.length-1?f.dx=b.processed_data[h-1].dx:(g=b.processed_data[h+1],f.dx=g.x-f.x)}return b.data=[b.processed_data],b.x_accessor=b.processed_x_accessor,b.y_accessor=b.processed_y_accessor,this}function y(b){"use strict";var c,d={},e=b.data[0],f="vertical"===b.bar_orientation?b.x_accessor:b.y_accessor,g="vertical"===b.bar_orientation?b.y_accessor:b.x_accessor;if(b.categorical_variables=[],b.binned===!1){c="object"==typeof e[0]?e.map(function(a){return a[f]}):e;for(var h,i=0;i<c.length;i++)h=c[i],-1===b.categorical_variables.indexOf(h)&&b.categorical_variables.push(h),d.hasOwnProperty(h)||(d[h]=0),d[h]+=1;d=Object.keys(d).map(function(a){var b={};return b[g]=d[a],b[f]=a,b})}else d=e,b.categorical_variables=a.set(d.map(function(a){return a[f]})).values(),b.categorical_variables.reverse();return b.data=[d],this}function z(a){"use strict";var b=a.data[0],c=b.map(function(b){return b[a.x_accessor]}),d=b.map(function(b){return b[a.y_accessor]});return a.least_squares&&(a.ls_line=B(c,d)),this}function A(b){var c=E(b.target),d=(b.data[0],b.scales.X.ticks(b.xax_count)[0]),e=b.scales.X.ticks(b.xax_count)[b.scales.X.ticks(b.xax_count).length-1];a.select(b.target).selectAll(".mg-least-squares-line").remove(),c.append("svg:line").attr("x1",b.scales.X(d)).attr("x2",b.scales.X(e)).attr("y1",b.scales.Y(b.ls_line.fit(d))).attr("y2",b.scales.Y(b.ls_line.fit(e))).attr("class","mg-least-squares-line")}function B(b,c){{var d,e,f,g;b.length}d=b[0]instanceof Date?b.map(function(a){return a.getTime()}):b,e=c[0]instanceof Date?c.map(function(a){return a.getTime()}):c;for(var h=a.mean(d),i=a.mean(e),j=0,k=0,l=0;l<d.length;l++)f=d[l],g=e[l],j+=(f-h)*(g-i),k+=(f-h)*(f-h);var m=j/k,n=i-m*h;return{x0:n,beta:m,fit:function(a){return n+a*m}}}function C(b){var c;return c="count"===b.format?function(c){var d=c%1!==0,e=a.format("0,000");return c=d?a.round(c,b.decimals):c,e(c)}:function(c){var d=(b.decimals?"."+b.decimals:"")+"%",e=a.format(d);return e(c)}}function D(b,c){return function(){for(var d=this,e=d.cloneNode(),f=d.getTotalLength(),g=(e.setAttribute("d",b),e).getTotalLength(),h=[0],i=0,j=c/Math.max(f,g);(i+=j)<1;)h.push(i);h.push(1);var k=h.map(function(b){var c=d.getPointAtLength(b*f),h=e.getPointAtLength(b*g);return a.interpolate([c.x,c.y],[h.x,h.y])});return function(a){return 1>a?"M"+k.map(function(b){return b(a)}).join("L"):b}}}function E(b){return a.select(b).select("svg")}function F(a){var b=a.replace(/[^a-zA-Z0-9 _]+/g,""),c=b.replace(/ +?/g,"");return c}function G(b,c){return Number(a.select(b).style(c).replace(/px/g,""))}function H(a){return G(a,"width")}function I(a){return G(a,"height")}function J(a){return P(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a}function K(a,b){var c,d=[],e=[];for(c=0;c<b.length;c++)d[b[c]]=!0;for(c=0;c<a.length;c++)d[a[c]]||e.push(a[c]);return e}function L(a,b){console.warn("Deprecation: "+a+(b?". This feature will be removed in "+b+".":" the near future.")),console.trace()}function M(a,b,c){var d,e=0;for(a.textContent=b,d=a.getBBox();d.width>c&&(a.textContent=b.slice(0,--e)+"...",d=a.getBBox(),"..."!==a.textContent););}function N(b){console.log("ERROR : ",b.target," : ",b.error),a.select(b.target).select(".mg-chart-title").append("i").attr("class","fa fa-x fa-exclamation-circle warning")}window.MG={version:"2.2.0"};var O={};MG.globals={},MG.deprecations={rollover_callback:{replacement:"mouseover",version:"2.0"},rollout_callback:{replacement:"mouseout",version:"2.0"},show_years:{replacement:"show_secondary_x_label",version:"2.1"}},MG.globals.link=!1,MG.globals.version="1.1",MG.data_graphic=function(){"use strict";var b={};b.all={missing_is_zero:!1,missing_is_hidden:!1,legend:"",legend_target:"",error:"",animate_on_load:!1,top:40,bottom:30,right:10,left:50,buffer:8,width:350,height:220,full_width:!1,full_height:!1,small_height_threshold:120,small_width_threshold:160,small_text:!1,xax_count:6,xax_tick_length:5,yax_count:5,yax_tick_length:5,x_extended_ticks:!1,y_extended_ticks:!1,y_scale_type:"linear",max_x:null,max_y:null,min_x:null,min_y:null,min_y_from_data:!1,point_size:2.5,x_accessor:"date",xax_units:"",x_label:"",x_axis:!0,y_axis:!0,y_accessor:"value",y_label:"",yax_units:"",x_rug:!1,y_rug:!1,transition_on_update:!0,mouseover:null,show_rollover_text:!0,show_confidence_band:null,xax_format:null,area:!0,chart_type:"line",data:[],decimals:2,format:"count",inflator:10/9,linked:!1,linked_format:"%Y-%m-%d",list:!1,baselines:null,markers:null,scalefns:{},scales:{},show_secondary_x_label:!0,target:"#viz",interpolate:"cardinal",custom_line_color_map:[],max_data_size:null,aggregate_rollover:!1,show_tooltips:!0},b.point={buffer:16,ls:!1,lowess:!1,point_size:2.5,size_accessor:null,color_accessor:null,size_range:null,color_range:null,size_domain:null,color_domain:null,color_type:"number"},b.histogram={mouseover:function(b){a.select("#histogram svg .mg-active-datapoint").text("Frequency Count: "+b.y)},binned:!1,bins:null,processed_x_accessor:"x",processed_y_accessor:"y",processed_dx_accessor:"dx",bar_margin:1},b.bar={y_accessor:"factor",x_accessor:"value",baseline_accessor:null,predictor_accessor:null,predictor_proportion:5,dodge_accessor:null,binned:!0,padding_percentage:0,outer_padding_percentage:.1,height:500,top:20,bar_height:20,left:70},b.missing={top:40,bottom:30,right:10,left:10,buffer:8,legend_target:"",width:350,height:220,missing_text:"Data currently missing or unavailable",scalefns:{},scales:{},show_missing_background:!0,interpolate:"cardinal"};var c=arguments[0];c||(c={}),c.list&&(c.x_accessor=0,c.y_accessor=1);for(var d in MG.deprecations)if(c.hasOwnProperty(d)){var e=MG.deprecations[d],f="Use of `args."+d+"` has been deprecated",g=e.replacement;if(g&&(c[g]?f+=". The replacement - `args."+g+"` - has already been defined. This definition will be discarded.":c[g]=c[d]),e.warned)continue;e.warned=!0,g&&(f+=" in favor of `args."+g+"`"),L(f,e.version)}var h;return"missing-data"===c.chart_type?(c=J(c,b.missing),O.missing(c)):"point"===c.chart_type?(h=J(b.point,b.all),c=J(c,h),O.point(c).mainPlot().markers().rollover().windowListeners()):"histogram"===c.chart_type?(h=J(b.histogram,b.all),c=J(c,h),O.histogram(c).mainPlot().markers().rollover().windowListeners()):"bar"===c.chart_type?(h=J(b.bar,b.all),c=J(c,h),O.bar(c).mainPlot().markers().rollover().windowListeners()):(c=J(c,b.all),O.line(c).markers().mainPlot().rollover().windowListeners()),c.data},"undefined"!=typeof jQuery&&(+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b,g=f&&f.selector;(e||"destroy"!=b)&&(g?(e||d.data("bs.tooltip",e={}),e[g]||(e[g]=new c(this,f))):e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}if("function"==typeof a().tooltip)return!0;var c=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};c.VERSION="3.3.1",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(this.options.viewport.selector||this.options.viewport);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c&&c.$tip&&c.$tip.is(":visible")?void(c.hoverState="in"):(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.options.container?a(this.options.container):this.$element.parent(),p=this.getPosition(o);h="bottom"==h&&k.bottom+m>p.bottom?"top":"top"==h&&k.top-m<p.top?"bottom":"right"==h&&k.right+l>p.width?"left":"left"==h&&k.left-l<p.left?"right":h,f.removeClass(n).addClass(h)}var q=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(q,h);var r=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",r).emulateTransitionEnd(c.TRANSITION_DURATION):r()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=this.tip(),g=a.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}
},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type)})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b,g=f&&f.selector;(e||"destroy"!=b)&&(g?(e||d.data("bs.popover",e={}),e[g]||(e[g]=new c(this,f))):e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}if("function"==typeof a().popover)return!0;var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.1",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},c.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery)),"undefined"!=typeof jQuery&&+function(a){"use strict";function b(b){b&&3===b.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=c(d),f={relatedTarget:this};e.hasClass("open")&&(e.trigger(b=a.Event("hide.bs.dropdown",f)),b.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",f)))}))}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}if("function"==typeof a().dropdown)return!0;var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.1",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=c(d),g=e.hasClass("open");if(!g&&27!=b.which||g&&27==b.which)return 27==b.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.divider):visible a",i=e.find('[role="menu"]'+h+', [role="listbox"]'+h);if(i.length){var j=i.index(b.target);38==b.which&&j>0&&j--,40==b.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',g.prototype.keydown)}(jQuery),MG.button_layout=function(a){"use strict";return this.target=a,this.feature_set={},this.public_name={},this.sorters={},this.manual=[],this.manual_map={},this.manual_callback={},this._strip_punctuation=function(a){var b=a.replace(/[^a-zA-Z0-9 _]+/g,""),c=b.replace(/ +?/g,"");return c},this.data=function(a){return this._data=a,this},this.manual_button=function(a,b,c){return this.feature_set[a]=b,this.manual_map[this._strip_punctuation(a)]=a,this.manual_callback[a]=c,this},this.button=function(a){return arguments.length>1&&(this.public_name[a]=arguments[1]),arguments.length>2&&(this.sorters[a]=arguments[2]),this.feature_set[a]=[],this},this.callback=function(a){return this._callback=a,this},this.display=function(){var a,b,c,d,e=this._callback,f=this.manual_callback,g=this.manual_map;c=Object.keys(this.feature_set);var h,i=function(b){return a[b]};for(h=0;h<this._data.length;h++){a=this._data[h],b=c.map(i);for(var j=0;j<c.length;j++)d=c[j],-1===this.feature_set[d].indexOf(b[j])&&this.feature_set[d].push(b[j])}for(d in this.feature_set)this.sorters.hasOwnProperty(d)&&this.feature_set[d].sort(this.sorters[d]);$(this.target).empty(),$(this.target).append("<div class='col-lg-12 segments text-center'></div>");var k=function(){var a,b=$(this).data("key"),c=$(this).data("feature");return $("."+c+"-btns button.btn span.title").html(b),g.hasOwnProperty(c)?(a=g[c],f[a](b)):e(c,b),!1};for(var l in this.feature_set){for(c=this.feature_set[l],$(this.target+" div.segments").append('<div class="btn-group '+this._strip_punctuation(l)+'-btns text-left"><button type="button" class="btn btn-default btn-lg dropdown-toggle" data-toggle="dropdown"><span class=\'which-button\'>'+(this.public_name.hasOwnProperty(l)?this.public_name[l]:l)+"</span><span class='title'>"+(this.manual_callback.hasOwnProperty(l)?this.feature_set[l][0]:"all")+'</span><span class="caret"></span></button><ul class="dropdown-menu" role="menu">'+(this.manual_callback.hasOwnProperty(l)?"":'<li><a href="#" data-feature="'+l+'" data-key="all">All</a></li>')+(this.manual_callback.hasOwnProperty(l)?"":'<li class="divider"></li>')+"</ul></div>"),h=0;h<c.length;h++)"all"!==c[h]&&void 0!==c[h]&&$(this.target+" div."+this._strip_punctuation(l)+"-btns ul.dropdown-menu").append('<li><a href="#" data-feature="'+this._strip_punctuation(l)+'" data-key="'+c[h]+'">'+c[h]+"</a></li>");$("."+this._strip_punctuation(l)+"-btns .dropdown-menu li a").on("click",k)}return this},this},O.line=function(b){"use strict";return this.args=b,this.init=function(a){return v(a),w(a),r(a),g(a),d(a),this},this.mainPlot=function(){var c,d=E(b.target),e=0,f=b.transition_on_update?1e3:0,g=function(a){return a[b.y_accessor]},h=a.svg.area().x(b.scalefns.xf).y0(b.scales.Y.range()[0]).y1(b.scalefns.yf).interpolate(b.interpolate),i=d.select(".mg-confidence-band");b.show_confidence_band&&(c=a.svg.area().x(b.scalefns.xf).y0(function(a){var c=b.show_confidence_band[0];return b.scales.Y(a[c])}).y1(function(a){var c=b.show_confidence_band[1];return b.scales.Y(a[c])}).interpolate(b.interpolate));for(var j,k,l=a.svg.line().x(b.scalefns.xf).y(b.scalefns.yf).interpolate(b.interpolate),m=a.svg.line().x(b.scalefns.xf).y(function(){return b.scales.Y(e)}).interpolate(b.interpolate),n="",o=b.data.length-1;o>=0;o--){j=b.data[o];var p=o+1;b.custom_line_color_map.length>0&&(p=b.custom_line_color_map[o]),b.data[o].line_id=p,b.show_confidence_band&&(k=i.empty()?d.append("path").attr("class","mg-confidence-band"):i.transition().duration(function(){return b.transition_on_update?1e3:0}),k.attr("d",c(b.data[o])).attr("clip-path","url(#mg-plot-window-"+F(b.target)+")"));var q=d.selectAll(".mg-area"+p+"-color"),r=b.area&&!b.use_data_y_min&&!b.y_axis_negative&&b.data.length<=1;r?q.empty()?d.append("path").attr("class","mg-main-area mg-area"+p+"-color").attr("d",h(b.data[o])).attr("clip-path","url(#mg-plot-window-"+F(b.target)+")"):(d.select(".mg-y-axis").node().parentNode.appendChild(q.node()),q.transition().duration(f).attr("d",h(b.data[o])).attr("clip-path","url(#mg-plot-window-"+F(b.target)+")")):q.empty()||q.remove();var s=d.select("path.mg-main-line.mg-line"+p+"-color");if(s.empty())b.animate_on_load?(e=a.median(b.data[o],g),d.append("path").attr("class","mg-main-line mg-line"+p+"-color").attr("d",m(b.data[o])).transition().duration(1e3).attr("d",l(b.data[o])).attr("clip-path","url(#mg-plot-window-"+F(b.target)+")")):d.append("path").attr("class","mg-main-line mg-line"+p+"-color").attr("d",l(b.data[o])).attr("clip-path","url(#mg-plot-window-"+F(b.target)+")");else{d.select(".mg-y-axis").node().parentNode.appendChild(s.node());var t=s.transition().duration(f);r?t.attr("d",l(b.data[o])):t.attrTween("d",D(l(b.data[o]),4))}var u=d.select(".mg-line"+p+"-color");if(b.missing_is_hidden&&null!==u.attr("d")){var v,w,x,y,z,A,B,C=u.attr("d").split("L"),G=b.scales.Y(0)+42.1234,H=[],I=2,J=0;C[0]=C[0].replace("M",""),C[C.length-1]=C[C.length-1].replace("Z",""),b.min_x&&H.push(0);for(var K=0;K<C.length-1;K++)v=C[K].split(","),w=C[K+1].split(","),x=Number(v[0]),y=Number(v[1]),z=Number(w[0]),A=Number(w[1]),B=Math.sqrt(Math.pow(x-z,2)+Math.pow(y-A,2)),A==G&&y!=G?(H.push(J||I),J=J?B:B-I):A!=G&&y==G?(H.push(J+=B),J=0):J+=B;H.length>0&&(H.push(u.node().getTotalLength()-H[H.length-1]),d.select(".mg-line"+p+"-color").attr("stroke-dasharray",H.join()))}b.legend&&(n="<span class='mg-line"+p+"-legend-color'>&mdash; "+b.legend[o]+"&nbsp; </span>"+n)}return b.legend&&a.select(b.legend_target).html(n),this},this.markers=function(){return s(b),this},this.rollover=function(){var c,d=E(b.target);d.selectAll(".mg-rollover-rect").remove(),d.selectAll(".mg-voronoi").remove(),d.selectAll(".mg-active-datapoint").remove(),d.selectAll(".mg-line-rollover-circle").remove(),d.selectAll(".mg-active-datapoint-container").remove(),d.append("g").attr("class","mg-active-datapoint-container").attr("transform","translate("+(b.width-b.right)+","+b.top/2+")").append("text").attr("class","mg-active-datapoint").classed("mg-active-datapoint-small",b.use_small_class).attr("xml:space","preserve").attr("text-anchor","end"),d.selectAll(".mg-line-rollover-circle").data(b.data).enter().append("circle").attr({"class":function(a){return["mg-line-rollover-circle","mg-line"+a.line_id+"-color","mg-area"+a.line_id+"-color"].join(" ")},cx:0,cy:0,r:0});for(var e=1,f=0;f<b.data.length;f++){for(var g=0;g<b.data[f].length;g++)b.data[f][g].line_id=b.custom_line_color_map.length>0?b.custom_line_color_map[f]:e;e++}var h,i;if(b.data.length>1&&!b.aggregate_rollover){var j=a.geom.voronoi().x(function(a){return b.scales.X(a[b.x_accessor]).toFixed(2)}).y(function(a){return b.scales.Y(a[b.y_accessor]).toFixed(2)}).clipExtent([[b.buffer,b.buffer],[b.width-b.buffer,b.height-b.buffer]]);c=d.append("g").attr("class","mg-voronoi"),h=a.nest().key(function(a){return b.scales.X(a[b.x_accessor])+","+b.scales.Y(a[b.y_accessor])}).rollup(function(a){return a[0]}).entries(a.merge(b.data.map(function(a){return a}))).map(function(a){return a.values}),c.selectAll("path").data(j(h)).enter().append("path").filter(function(a){return void 0!==a}).attr("d",function(a){return"M"+a.join("L")+"Z"}).datum(function(a){return a.point}).attr("class",function(c){if(b.linked){var d=c[b.x_accessor],e=a.time.format(b.linked_format),g="number"==typeof d?f:e(d);return"mg-line"+c.line_id+"-color roll_"+g}return"mg-line"+c.line_id+"-color"}).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b))}else b.data.length>1&&b.aggregate_rollover?(h=a.nest().key(function(a){return a[b.x_accessor]}).entries(a.merge(b.data)),i=h.map(function(a){return b.scales.X(new Date(a.key))}),c=d.append("g").attr("class","mg-rollover-rect"),c.selectAll(".mg-rollover-rects").data(h).enter().append("rect").attr("x",function(a,c){return 1===i.length?b.left+b.buffer:0===c?i[c].toFixed(2):((i[c-1]+i[c])/2).toFixed(2)}).attr("y",b.top).attr("width",function(a,c){return 1===i.length?b.width-b.right-b.buffer:0===c?((i[c+1]-i[c])/2).toFixed(2):c==i.length-1?((i[c]-i[c-1])/2).toFixed(2):((i[c+1]-i[c-1])/2).toFixed(2)}).attr("height",b.height-b.bottom-b.top-b.buffer).attr("opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b))):(e=1,b.custom_line_color_map.length>0&&(e=b.custom_line_color_map[0]),c=d.append("g").attr("class","mg-rollover-rect"),i=b.data[0].map(b.scalefns.xf),c.selectAll(".mg-rollover-rects").data(b.data[0]).enter().append("rect").attr("class",function(c,d){if(b.linked){var f=c[b.x_accessor],g=a.time.format(b.linked_format),h="number"==typeof f?d:g(f);return"mg-line"+e+"-color roll_"+h}return"mg-line"+e+"-color"}).attr("x",function(a,c){return 1===i.length?b.left+b.buffer:0===c?i[c].toFixed(2):((i[c-1]+i[c])/2).toFixed(2)}).attr("y",function(a){return b.data.length>1?b.scalefns.yf(a)-6:b.top}).attr("width",function(a,c){return 1===i.length?b.width-b.right-b.buffer:0===c?((i[c+1]-i[c])/2).toFixed(2):c===i.length-1?((i[c]-i[c-1])/2).toFixed(2):((i[c+1]-i[c-1])/2).toFixed(2)}).attr("height",function(){return b.data.length>1?12:b.height-b.bottom-b.top-b.buffer}).attr("opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b)));if(1==b.data.length&&1==b.data[0].length)d.select(".mg-rollover-rect rect").on("mouseover")(b.data[0][0],0);else if(b.data.length>1)for(var f=0;f<b.data.length;f++)1==b.data[f].length&&d.selectAll(".mg-voronoi .mg-line"+(f+1)+"-color").on("mouseover")(b.data[f][0],0);return this},this.rolloverOn=function(b){var c,d=E(b.target);switch(b.processed.x_time_frame){case"seconds":c=a.time.format("%b %e, %Y  %H:%M:%S");break;case"less-than-a-day":c=a.time.format("%b %e, %Y  %I:%M%p");break;case"four-days":c=a.time.format("%b %e, %Y  %I:%M%p");break;default:c=a.time.format("%b %e, %Y")}return function(e,f){if(b.aggregate_rollover&&b.data.length>1)d.selectAll("circle.mg-line-rollover-circle").style("opacity",0),e.values.forEach(function(a){if(a[b.x_accessor]>=b.processed.min_x&&a[b.x_accessor]<=b.processed.max_x&&a[b.y_accessor]>=b.processed.min_y&&a[b.y_accessor]<=b.processed.max_y){d.select("circle.mg-line"+a.line_id+"-color").attr({cx:function(){return b.scales.X(a[b.x_accessor]).toFixed(2)},cy:function(){return b.scales.Y(a[b.y_accessor]).toFixed(2)},r:b.point_size}).style("opacity",1)}});else{if(b.missing_is_hidden&&0==e[b.y_accessor]&&e.missing)return;if(e[b.x_accessor]>=b.processed.min_x&&e[b.x_accessor]<=b.processed.max_x&&e[b.y_accessor]>=b.processed.min_y&&e[b.y_accessor]<=b.processed.max_y&&d.selectAll("circle.mg-line-rollover-circle").attr("class","").attr("class","mg-area"+e.line_id+"-color").classed("mg-line-rollover-circle",!0).attr("cx",function(){return b.scales.X(e[b.x_accessor]).toFixed(2)}).attr("cy",function(){return b.scales.Y(e[b.y_accessor]).toFixed(2)}).attr("r",b.point_size).style("opacity",1),b.linked&&!MG.globals.link){MG.globals.link=!0;var g=e[b.x_accessor],h=a.time.format(b.linked_format),i="number"==typeof g?f:h(g);a.selectAll(".mg-line"+e.line_id+"-color.roll_"+i).each(function(b,c){a.select(this).on("mouseover")(b,c)})}}d.selectAll("text").filter(function(a){return e===a}).attr("opacity",.3);var j=C(b);if(b.show_rollover_text){var k=d.select(".mg-active-datapoint"),l=0,m=1.1;if(k.select("*").remove(),b.aggregate_rollover&&b.data.length>1){if(b.time_series){var n=new Date(e.key);k.append("tspan").text((c(n)+"  "+b.yax_units).trim()),l=1,e.values.forEach(function(a){var c=k.append("tspan").attr({x:0,y:l*m+"em"}).text(j(a[b.y_accessor]));k.append("tspan").attr({x:-c.node().getComputedTextLength(),y:l*m+"em"}).text("— ").classed("mg-hover-line"+a.line_id+"-color",!0).style("font-weight","bold"),l++}),k.append("tspan").attr("x",0).attr("y",l*m+"em").text(" ")}else e.values.forEach(function(a){var c=k.append("tspan").attr({x:0,y:l*m+"em"}).text(b.x_accessor+": "+a[b.x_accessor]+", "+b.y_accessor+": "+b.yax_units+j(a[b.y_accessor]));k.append("tspan").attr({x:-c.node().getComputedTextLength(),y:l*m+"em"}).text("— ").classed("mg-hover-line"+a.line_id+"-color",!0).style("font-weight","bold"),l++});k.append("tspan").attr("x",0).attr("y",l*m+"em").text(" ")}else if(b.time_series){var o=new Date(+e[b.x_accessor]);o.setDate(o.getDate()),k.append("tspan").text(c(o)+"  "+b.yax_units+j(e[b.y_accessor]))}else k.append("tspan").text(b.x_accessor+": "+e[b.x_accessor]+", "+b.y_accessor+": "+b.yax_units+j(e[b.y_accessor]))}b.mouseover&&b.mouseover(e,f)}},this.rolloverOff=function(b){var c=E(b.target);return function(d,e){if(b.linked&&MG.globals.link){MG.globals.link=!1;var f=d[b.x_accessor],g=a.time.format(b.linked_format),h="number"==typeof f?e:g(f);a.selectAll(".roll_"+h).each(function(b){a.select(this).on("mouseout")(b)})}c.selectAll("circle.mg-line-rollover-circle").style("opacity",function(){return 1==b.data.length&&1==b.data[0].length?1:0}),c.select(".mg-active-datapoint").text(""),b.mouseout&&b.mouseout(d,e)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.windowListeners=function(){return t(this.args),this},this.init(b),this},O.histogram=function(b){"use strict";return this.args=b,this.init=function(a){return v(a),x(a),r(a),g(a),d(a),this},this.mainPlot=function(){var a=E(b.target);a.selectAll(".mg-histogram").remove();var c=a.append("g").attr("class","mg-histogram"),d=c.selectAll(".mg-bar").data(b.data[0]).enter().append("g").attr("class","mg-bar").attr("transform",function(a){return"translate("+b.scales.X(a[b.x_accessor]).toFixed(2)+","+b.scales.Y(a[b.y_accessor]).toFixed(2)+")"});return d.append("rect").attr("x",1).attr("width",function(){return 1===b.data[0].length?(b.scalefns.xf(b.data[0][0])-b.bar_margin).toFixed(2):(b.scalefns.xf(b.data[0][1])-b.scalefns.xf(b.data[0][0])-b.bar_margin).toFixed(2)}).attr("height",function(a){return 0===a[b.y_accessor]?0:(b.height-b.bottom-b.buffer-b.scales.Y(a[b.y_accessor])).toFixed(2)}),this},this.markers=function(){return s(b),this},this.rollover=function(){var a=E(b.target);a.selectAll(".mg-rollover-rect").remove(),a.selectAll(".mg-active-datapoint").remove(),a.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",b.width-b.right).attr("y",b.top/2).attr("text-anchor","end");var c=a.append("g").attr("class","mg-rollover-rect"),d=c.selectAll(".mg-bar").data(b.data[0]).enter().append("g").attr("class",function(a,c){return b.linked?"mg-rollover-rects roll_"+c:"mg-rollover-rects"}).attr("transform",function(a){return"translate("+b.scales.X(a[b.x_accessor])+",0)"});return d.append("rect").attr("x",1).attr("y",0).attr("width",function(a,c){return 1===b.data[0].length?(b.scalefns.xf(b.data[0][0])-b.bar_margin).toFixed(2):c!==b.data[0].length-1?(b.scalefns.xf(b.data[0][c+1])-b.scalefns.xf(a)).toFixed(2):(b.scalefns.xf(b.data[0][1])-b.scalefns.xf(b.data[0][0])).toFixed(2)}).attr("height",function(){return b.height}).attr("opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b)),this},this.rolloverOn=function(b){{var c=E(b.target);a.time.format("%Y-%m-%d")}return function(d,e){c.selectAll("text").filter(function(a){return d===a}).attr("opacity",.3);var f=a.time.format("%b %e, %Y"),g=C(b);c.selectAll(".mg-bar rect").filter(function(a,b){return b===e}).classed("active",!0),b.linked&&!MG.globals.link&&(MG.globals.link=!0,a.selectAll(".mg-rollover-rects.roll_"+e+" rect").each(function(b){a.select(this).on("mouseover")(b,e)})),b.show_rollover_text&&c.select(".mg-active-datapoint").text(function(){if(b.time_series){var a=new Date(+d[b.x_accessor]);return a.setDate(a.getDate()),f(a)+"  "+b.yax_units+g(d[b.y_accessor])}return b.x_accessor+": "+g(d[b.x_accessor])+", "+b.y_accessor+": "+b.yax_units+g(d[b.y_accessor])}),b.mouseover&&b.mouseover(d,e)}},this.rolloverOff=function(b){var c=E(b.target);return function(d,e){b.linked&&MG.globals.link&&(MG.globals.link=!1,a.selectAll(".mg-rollover-rects.roll_"+e+" rect").each(function(b){a.select(this).on("mouseout")(b,e)})),c.selectAll(".mg-bar rect").classed("active",!1),c.select(".mg-active-datapoint").text(""),b.mouseout&&b.mouseout(d,e)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.windowListeners=function(){return t(this.args),this},this.init(b),this},O.point=function(b){"use strict";return this.args=b,this.init=function(a){return v(a),z(a),r(a),g(a),d(a),this},this.markers=function(){return s(b),b.least_squares&&A(b),this},this.mainPlot=function(){var a,c=E(b.target);c.selectAll(".mg-points").remove(),a=c.append("g").classed("mg-points",!0);var d=a.selectAll("circle").data(b.data[0]).enter().append("svg:circle").attr("class",function(a,b){return"path-"+b}).attr("cx",b.scalefns.xf).attr("cy",b.scalefns.yf);return null!==b.color_accessor?(d.attr("fill",b.scalefns.color),d.attr("stroke",b.scalefns.color)):d.classed("mg-points-mono",!0),null!==b.size_accessor?d.attr("r",b.scalefns.size):d.attr("r",b.point_size),this},this.rollover=function(){var c=E(b.target);c.selectAll(".mg-voronoi").remove(),c.selectAll(".mg-active-datapoint").remove(),c.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",b.width-b.right).attr("y",b.top/2).attr("text-anchor","end");var d=a.geom.voronoi().x(b.scalefns.xf).y(b.scalefns.yf).clipExtent([[b.buffer,b.buffer],[b.width-b.buffer,b.height-b.buffer]]),e=c.append("g").attr("class","mg-voronoi");return e.selectAll("path").data(d(b.data[0])).enter().append("path").attr("d",function(a){return void 0!==a?"M"+a.join(",")+"Z":void 0}).attr("class",function(a,b){return"path-"+b}).style("fill-opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b)),this},this.rolloverOn=function(b){var c=E(b.target);return function(d,e){c.selectAll(".mg-points circle").classed("selected",!1);var f=c.selectAll(".mg-points circle.path-"+e).classed("selected",!0);b.size_accessor?f.attr("r",function(a){return b.scalefns.size(a)+1}):f.attr("r",b.point_size),b.linked&&!globals.link&&(globals.link=!0,a.selectAll(".mg-voronoi .path-"+e).each(function(){a.select(this).on("mouseover")(d,e)}));var g=a.time.format("%b %e, %Y"),h=C(b);b.show_rollover_text&&c.select(".mg-active-datapoint").text(function(){if(b.time_series){var a=new Date(+d.point[b.x_accessor]);return a.setDate(a.getDate()),g(a)+"  "+b.yax_units+h(d.point[b.y_accessor])}return b.x_accessor+": "+h(d.point[b.x_accessor])+", "+b.y_accessor+": "+b.yax_units+h(d.point[b.y_accessor])}),b.mouseover&&b.mouseover(d,e)}},this.rolloverOff=function(b){var c=E(b.target);return function(d,e){b.linked&&globals.link&&(globals.link=!1,a.selectAll(".mg-voronoi .path-"+e).each(function(){a.select(this).on("mouseout")(d,e)}));var f=c.selectAll(".mg-points circle").classed("unselected",!1).classed("selected",!1);b.size_accessor?f.attr("r",b.scalefns.size):f.attr("r",b.point_size),c.select(".mg-active-datapoint").text(""),b.mouseout&&b.mouseout(d,e)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.update=function(){return this},this.windowListeners=function(){return t(this.args),this},this.init(b),this},O.bar=function(b){"use strict";return this.args=b,this.is_vertical=!0,this.init=function(a){return v(a),y(a),r(a),this.is_vertical="vertical"===a.bar_orientation,this.is_vertical?(h(a),d(a)):(g(a),e(a)),this},this.mainPlot=function(){var a,c,d,e,f,g=E(b.target),h=b.data[0],i=g.select(".mg-barplot"),j=i.empty(),k=j&&b.animate_on_load,l=k||b.transition_on_update,m=b.transition_duration||1e3;j?(i=g.append("g").classed("mg-barplot",!0),a=i.selectAll(".mg-bar").data(h).enter().append("rect").classed("mg-bar",!0),b.predictor_accessor&&(c=i.selectAll(".mg-bar-prediction").data(h).enter().append("rect").classed("mg-bar-prediction",!0)),b.baseline_accessor&&(f=i.selectAll(".mg-bar-baseline").data(h).enter().append("line").classed("mg-bar-baseline",!0))):(g.select(".mg-y-axis").node().parentNode.appendChild(i.node()),console.log("waylee"),a=i.selectAll("rect.mg-bar"),b.predictor_accessor&&(c=i.selectAll(".mg-bar-prediction")),b.baseline_accessor&&(f=i.selectAll(".mg-bar-baseline")));var n;return this.is_vertical?(n=b.scales.X.rangeBand()/1.5,k&&a.attr("height",0).attr("y",b.scales.Y(0)),l&&(a=a.transition().duration(m)),a.attr("y",function(a){return b.scales.Y(0)-(b.scales.Y(0)-b.scalefns.yf(a))}).attr("x",function(a){return b.scalefns.xf(a)+n/2}).attr("width",n).attr("height",function(a){return 0-(b.scalefns.yf(a)-b.scales.Y(0))}),b.predictor_accessor&&(d=b.predictor_proportion,e=d-1,k&&c.attr("height",0).attr("y",b.scales.Y(0)),l&&(c=c.transition().duration(m)),c.attr("y",function(a){return b.scales.Y(0)-(b.scales.Y(0)-b.scales.Y(a[b.predictor_accessor]))}).attr("x",function(a){return b.scalefns.xf(a)+e*n/(2*d)+n/2}).attr("width",n/d).attr("height",function(a){return 0-(b.scales.Y(a[b.predictor_accessor])-b.scales.Y(0))})),b.baseline_accessor&&(d=b.predictor_proportion,k&&f.attr({y1:b.scales.Y(0),y2:b.scales.Y(0)}),l&&(f=f.transition().duration(m)),f.attr("x1",function(a){return b.scalefns.xf(a)+n/2-n/d+n/2}).attr("x2",function(a){return b.scalefns.xf(a)+n/2+n/d+n/2}).attr("y1",function(a){return b.scales.Y(a[b.baseline_accessor])}).attr("y2",function(a){return b.scales.Y(a[b.baseline_accessor])}))):(n=b.scales.Y.rangeBand()/1.5,k&&a.attr("width",0),l&&(a=a.transition().duration(m)),a.attr("x",b.scales.X(0)).attr("y",function(a){return b.scalefns.yf(a)+n/2}).attr("height",n).attr("width",function(a){return b.scalefns.xf(a)-b.scales.X(0)}),b.predictor_accessor&&(d=b.predictor_proportion,e=d-1,k&&c.attr("width",0),l&&(c=c.transition().duration(m)),c.attr("x",b.scales.X(0)).attr("y",function(a){return b.scalefns.yf(a)+e*n/(2*d)+n/2}).attr("height",n/d).attr("width",function(a){return b.scales.X(a[b.predictor_accessor])-b.scales.X(0)})),b.baseline_accessor&&(d=b.predictor_proportion,k&&f.attr({x1:b.scales.X(0),x2:b.scales.X(0)}),l&&(f=f.transition().duration(m)),f.attr("x1",function(a){return b.scales.X(a[b.baseline_accessor])}).attr("x2",function(a){return b.scales.X(a[b.baseline_accessor])}).attr("y1",function(a){return b.scalefns.yf(a)+n/2-n/d+n/2}).attr("y2",function(a){return b.scalefns.yf(a)+n/2+n/d+n/2}))),this},this.markers=function(){return s(b),this},this.rollover=function(){var a,c=E(b.target);c.selectAll(".mg-rollover-rect").remove(),c.selectAll(".mg-active-datapoint").remove(),c.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",b.width-b.right).attr("y",b.top/2).attr("dy",".35em").attr("text-anchor","end"),a=c.append("g").attr("class","mg-rollover-rect");var d=a.selectAll(".mg-bar-rollover").data(b.data[0]).enter().append("rect").attr("class","mg-bar-rollover");return this.is_vertical?d.attr("x",b.scalefns.xf).attr("y",function(){return b.scales.Y(0)-b.height}).attr("width",b.scales.X.rangeBand()).attr("height",b.height).attr("opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b)):d.attr("x",b.scales.X(0)).attr("y",b.scalefns.yf).attr("width",b.width).attr("height",b.scales.Y.rangeBand()+2).attr("opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b)),this},this.rolloverOn=function(b){var c=E(b.target),d=this.is_vertical?b.x_accessor:b.y_accessor,e=this.is_vertical?b.y_accessor:b.x_accessor,f=this.is_vertical?b.yax_units:b.xax_units;return function(g,h){c.selectAll("text").filter(function(a){return g===a}).attr("opacity",.3);var i=a.time.format("%b %e, %Y"),j=C(b);c.selectAll("g.mg-barplot .mg-bar").filter(function(a,b){return b===h}).classed("active",!0),b.show_rollover_text&&c.select(".mg-active-datapoint").text(function(){if(b.time_series){var a=new Date(+g[e]);return a.setDate(a.getDate()),i(a)+"  "+f+j(g[d])}return g[d]+": "+j(g[e])}),b.mouseover&&b.mouseover(g,h)}},this.rolloverOff=function(a){var b=E(a.target);return function(c,d){b.selectAll("g.mg-barplot .mg-bar").classed("active",!1),b.select(".mg-active-datapoint").text(""),a.mouseout&&a.mouseout(c,d)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.windowListeners=function(){return t(this.args),this},this.init(b),this},MG.data_table=function(c){"use strict";return this.args=c,this.args.standard_col={width:150,font_size:12,font_weight:"normal"},this.args.columns=[],this.formatting_options=[["color","color"],["font-weight","font_weight"],["font-style","font_style"],["font-size","font_size"]],this._strip_punctuation=function(a){var b=a.replace(/[^a-zA-Z0-9 _]+/g,""),c=b.replace(/ +?/g,"");return c},this._format_element=function(a,b,c){this.formatting_options.forEach(function(d){var e=d[0],f=d[1];c[f]&&a.style(e,"string"==typeof c[f]||"number"==typeof c[f]?c[f]:c[f](b))})},this._add_column=function(a,b){var c=this.args.standard_col,d=J(MG.clone(a),MG.clone(c));d.type=b,this.args.columns.push(d)},this.target=function(){var a=arguments[0];return this.args.target=a,this},this.title=function(){return this._add_column(arguments[0],"title"),this},this.text=function(){return this._add_column(arguments[0],"text"),this},this.bullet=function(){return this},this.sparkline=function(){return this},this.number=function(){return this._add_column(arguments[0],"number"),this},this.display=function(){var c=this.args;b(c);var d,e,f,g,h,i,j,k,l,m,n,o,p=c.target,q=a.select(p).append("table").classed("mg-data-table",!0),r=q.append("colgroup"),s=q.append("thead"),t=q.append("tbody");for(f=s.append("tr"),o=0;o<c.columns.length;o++){var u=c.columns[o];i=u.type,k=u.label,k=void 0===k?"":k,g=f.append("th").style("width",u.width).style("text-align","title"===i?"left":"right").text(k),c.show_tooltips&&u.description&&(g.append("i").classed("fa",!0).classed("fa-question-circle",!0).classed("fa-inverse",!0),$(g[0]).popover({html:!0,animation:!1,content:u.description,trigger:"hover",placement:"top",container:$(g[0])}))}for(o=0;o<c.columns.length;o++)n=r.append("col"),"number"===c.columns[o].type&&n.attr("align","char").attr("char",".");for(var v=0;v<c.data.length;v++){f=t.append("tr");for(var w=0;w<c.columns.length;w++){if(d=c.columns[w],h=d.accessor,j=l=c.data[v][h],i=d.type,"number"===i){if(d.hasOwnProperty("round")&&!d.hasOwnProperty("format")&&(l=a.format("0,."+d.round+"f")(l)),d.hasOwnProperty("value_formatter")&&(l=d.value_formatter(l)),d.hasOwnProperty("format")){d.round&&(l=a.round(l,d.round));
var x,y=d.format;"percentage"===y&&(x=a.format("%p")),"count"===y&&(x=a.format("0,000")),"temperature"===y&&(x=function(a){return a+"°"}),l=x(l)}d.hasOwnProperty("currency")&&(l=d.currency+l)}m=f.append("td").classed("table-"+i,!0).classed("table-"+i+"-"+this._strip_punctuation(h),!0).attr("data-value",j).style("width",d.width).style("text-align","title"===i||"text"===i?"left":"right"),this._format_element(m,j,d),"title"===i?(e=m.append("div").text(l),this._format_element(e,l,d),c.columns[w].hasOwnProperty("secondary_accessor")&&m.append("div").text(c.data[v][c.columns[w].secondary_accessor]).classed("secondary-title",!0)):m.text(l)}}return this},this},O.missing=function(c){"use strict";return this.args=c,this.init=function(c){b(c),a.select(c.target).selectAll("svg").data([c]).enter().append("svg").attr("width",c.width).attr("height",c.height);var d=E(c.target);if(c.width!==Number(d.attr("width"))&&d.attr("width",c.width),c.height!==Number(d.attr("height"))&&d.attr("height",c.height),a.select(c.target).selectAll("svg *").remove(),d.classed("mg-missing",!0),c.legend_target&&a.select(c.legend_target).html(""),c.show_missing_background){for(var e=[],f=1;50>=f;f++)e.push({x:f,y:Math.random()-.03*f});c.scales.X=a.scale.linear().domain([0,e.length]).range([c.left+c.buffer,c.width-c.right-c.buffer]),c.scales.Y=a.scale.linear().domain([-2,2]).range([c.height-c.bottom-2*c.buffer,c.top]),c.scalefns.xf=function(a){return c.scales.X(a.x)},c.scalefns.yf=function(a){return c.scales.Y(a.y)};var g=a.svg.line().x(c.scalefns.xf).y(c.scalefns.yf).interpolate(c.interpolate),h=a.svg.area().x(c.scalefns.xf).y0(c.scales.Y.range()[0]).y1(c.scalefns.yf).interpolate(c.interpolate),i=d.append("g").attr("class","mg-missing-pane");i.append("svg:rect").classed("mg-missing-background",!0).attr("x",c.buffer).attr("y",c.buffer).attr("width",c.width-2*c.buffer).attr("height",c.height-2*c.buffer).attr("rx",15).attr("ry",15),i.append("path").attr("class","mg-main-line mg-line1-color").attr("d",g(e)),i.append("path").attr("class","mg-main-area mg-area1-color").attr("d",h(e))}return d.selectAll(".mg-missing-text").data([c.missing_text]).enter().append("text").attr("class","mg-missing-text").attr("x",c.width/2).attr("y",c.height/2).attr("dy",".50em").attr("text-anchor","middle").text(c.missing_text),this},this.init(c),this},MG.convert={},MG.convert.date=function(b,c,d){return d="undefined"==typeof d?"%Y-%m-%d":d,b=b.map(function(b){var e=a.time.format(d);return b[c]=e.parse(b[c]),b})},MG.convert.number=function(a,b){return a=a.map(function(a){return a[b]=Number(a[b]),a})};var P=function(a,b,c){if(null===a)return a;if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(b.call(c,a[d],d,a)===breaker)return}else for(var f in a)if(b.call(c,a[f],f,a)===breaker)return;return a};MG.clone=function(a){var b;if(null===a||"object"!=typeof a)return a;if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;if(a instanceof Array){b=[];for(var c=0,d=a.length;d>c;c++)b[c]=MG.clone(a[c]);return b}if(a instanceof Object){b={};for(var e in a)a.hasOwnProperty(e)&&(b[e]=MG.clone(a[e]));return b}throw new Error("Unable to copy obj! Its type isn't supported.")}});